<h1>Item / Equipment Cards</h1>
<% if logged_in? && current_user.admin? %>
  <p><%= link_to "Add an Item", new_item_path %></p>
<% end %>

<p>Click on a item to see the card and any scenarios it appears in.</p>
  <p>Items can be sorted by:</p>
      <ul>
        <li>the box (<strong>origin</strong>) the item card came in</li>
        <li>the <strong>type</strong> of item it is</li>
        <li>item <strong>name</strong> listed with their stats</li>
      </ul>
<div align="center">
  <a href="" id="show_byorigin" class="toggles"><button class="btn btn-item active">By Origin</button></a>
  <a href="" id="show_bytype" class="toggles"><button class="btn btn-item">By Type</button></a>
  <a href="" id="show_bystat" class="toggles"><button class="btn btn-item">Name / Stats</button></a>
</div>
<hr>

<div id="by_origin">
  <div class="row">
    <div class="col-md-6 col-sm-8">

      <div class="card">
        <div class="card-header" id="headingCore">
          <button class="btn btn-link" data-toggle="collapse" data-target="#collapseCore">
          &#x25BC;&nbsp;&#x25B2;&nbsp;&nbsp;Core Game</button>
        </div>
        <div class="card-body">
          <div id="collapseCore" class="collapse in">
            <table class="table stats itemstats">
              <thead>
                <tr>
                  <th class="w40">Item</th>
                  <th class="w35">Type</th>
                  <th class="w15">Count</th>
                  <th class="w10">Scenarios</th>
                </tr>
              </thead>
              <% @core.each do |item| %>
              <tr>
                <td class="item" align="center"><%= link_to item.name, item_path(item) %></td>
                <td><%= item.role %></td>
                <td><%= item.count %></td>
                <td><%= item.scenarios.count %></td>
              </tr>
              <% end %>
            </table>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-header" id="headingKhitai">
          <button class="btn btn-link" data-toggle="collapse" data-target="#collapseKhitai">
          &#x25BC;&nbsp;&#x25B2;&nbsp;&nbsp;Khitai</button>
        </div>
        <div class="card-body">
          <div id="collapseKhitai" class="collapse in">
            <table class="table stats itemstats">
              <thead>
                <tr>
                  <th class="w40">Item</th>
                  <th class="w35">Type</th>
                  <th class="w15">Count</th>
                  <th class="w10">Scenarios</th>
                </tr>
              </thead>
              <% @khitai.each do |item| %>
              <tr>
                <td class="item" align="center"><%= link_to item.name, item_path(item) %></td>
                <td><%= item.role %></td>
                <td><%= item.count %></td>
                <td><%= item.scenarios.count %></td>
              </tr>
              <% end %>
            </table>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-header" id="headingNordheim">
          <button class="btn btn-link" data-toggle="collapse" data-target="#collapseNordheim">
          &#x25BC;&nbsp;&#x25B2;&nbsp;&nbsp;Nordheim</button>
        </div>
        <div class="card-body">
          <div id="collapseNordheim" class="collapse in">
            <table class="table stats itemstats">
              <thead>
                <tr>
                  <th class="w40">Item</th>
                  <th class="w35">Type</th>
                  <th class="w15">Count</th>
                  <th class="w10">Scenarios</th>
                </tr>
              </thead>
              <% @nordheim.each do |item| %>
              <tr>
                <td class="item" align="center"><%= link_to item.name, item_path(item) %></td>
                <td><%= item.role %></td>
                <td><%= item.count %></td>
                <td><%= item.scenarios.count %></td>
              </tr>
              <% end %>
            </table>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-header" id="headingStygia">
          <button class="btn btn-link" data-toggle="collapse" data-target="#collapseStygia">
          &#x25BC;&nbsp;&#x25B2;&nbsp;&nbsp;Stygia</button>
        </div>
        <div class="card-body">
          <div id="collapseStygia" class="collapse in">
            <table class="table stats itemstats">
              <thead>
                <tr>
                  <th class="w40">Item</th>
                  <th class="w35">Type</th>
                  <th class="w15">Count</th>
                  <th class="w10">Scenarios</th>
                </tr>
              </thead>
              <% @stygia.each do |item| %>
              <tr>
                <td class="item" align="center"><%= link_to item.name, item_path(item) %></td>
                <td><%= item.role %></td>
                <td><%= item.count %></td>
                <td><%= item.scenarios.count %></td>
              </tr>
              <% end %>
            </table>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-header" id="headingConqueror">
          <button class="btn btn-link" data-toggle="collapse" data-target="#collapseConqueror">
          &#x25BC;&nbsp;&#x25B2;&nbsp;&nbsp;Conan the Conqueror</button>
        </div>
        <div class="card-body">
          <div id="collapseConqueror" class="collapse in">
            <table class="table stats itemstats">
              <thead>
                <tr>
                  <th class="w40">Item</th>
                  <th class="w35">Type</th>
                  <th class="w15">Count</th>
                  <th class="w10">Scenarios</th>
                </tr>
              </thead>
              <% @conqueror.each do |item| %>
              <tr>
                <td class="item" align="center"><%= link_to item.name, item_path(item) %></td>
                <td><%= item.role %></td>
                <td><%= item.count %></td>
                <td><%= item.scenarios.count %></td>
              </tr>
              <% end %>
            </table>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-6 col-sm-8">
      <div class="card">
        <div class="card-header" id="headingStretch">
          <button class="btn btn-link" data-toggle="collapse" data-target="#collapseStretch">
          &#x25BC;&nbsp;&#x25B2;&nbsp;&nbsp;Stretch Goal</button>
        </div>
        <div class="card-body">
          <div id="collapseStretch" class="collapse in">
            <table class="table stats itemstats">
              <thead>
                <tr>
                  <th class="w40">Item</th>
                  <th class="w35">Type</th>
                  <th class="w15">Count</th>
                  <th class="w10">Scenarios</th>
                </tr>
              </thead>
              <% @stretch.each do |item| %>
              <tr>
                <td class="item" align="center"><%= link_to item.name, item_path(item) %></td>
                <td><%= item.role %></td>
                <td><%= item.count %></td>
                <td><%= item.scenarios.count %></td>
              </tr>
              <% end %>
            </table>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-header" id="headingBrom">
          <button class="btn btn-link" data-toggle="collapse" data-target="#collapseBrom">
          &#x25BC;&nbsp;&#x25B2;&nbsp;&nbsp;Brom Box</button>
        </div>
        <div class="card-body">
          <div id="collapseBrom" class="collapse in">
            <table class="table stats itemstats">
              <thead>
                <tr>
                  <th class="w40">Item</th>
                  <th class="w35">Type</th>
                  <th class="w15">Count</th>
                  <th class="w10">Scenarios</th>
                </tr>
              </thead>
              <% @brom.each do |item| %>
              <tr>
                <td class="item" align="center"><%= link_to item.name, item_path(item) %></td>
                <td><%= item.role %></td>
                <td><%= item.count %></td>
                <td><%= item.scenarios.count %></td>
              </tr>
              <% end %>
            </table>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-header" id="headingCampaign">
          <button class="btn btn-link" data-toggle="collapse" data-target="#collapseCampaign">
          &#x25BC;&nbsp;&#x25B2;&nbsp;&nbsp;Legend of the Devil in Iron</button>
        </div>
        <div class="card-body">
          <div id="collapseCampaign" class="collapse in">
            <table class="table stats itemstats">
              <thead>
                <tr>
                  <th class="w40">Item</th>
                  <th class="w35">Type</th>
                  <th class="w15">Count</th>
                  <th class="w10">Scenarios</th>
                </tr>
              </thead>
              <% @campaign.each do |item| %>
              <tr>
                <td class="item" align="center"><%= link_to item.name, item_path(item) %></td>
                <td><%= item.role %></td>
                <td><%= item.count %></td>
                <td><%= item.scenarios.count %></td>
              </tr>
              <% end %>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


<div id="by_type">
  <div class="row">
    <div class="col-md-6 col-sm-8">

      <div class="card">
        <div class="card-header" id="headingWeapon">
          <button class="btn btn-link" data-toggle="collapse" data-target="#collapseWeapon">
          &#x25BC;&nbsp;&#x25B2;&nbsp;&nbsp;Weapon</button>
        </div>
        <div class="card-body">
          <div id="collapseWeapon" class="collapse in">
            <table class="table stats itemstats">
              <thead>
                <tr>
                  <th class="w40">Item</th>
                  <th class="w35">Origin</th>
                  <th class="w15">Count</th>
                  <th class="w10">Scenarios</th>
                </tr>
              </thead>
              <% @weapon.each do |item| %>
              <tr>
                <td class="item" align="center"><%= link_to item.name, item_path(item) %></td>
                <td><%= item.origin %></td>
                <td><%= item.count %></td>
                <td><%= item.scenarios.count %></td>
              </tr>
              <% end %>
            </table>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-header" id="headingArmor">
          <button class="btn btn-link" data-toggle="collapse" data-target="#collapseArmor">
          &#x25BC;&nbsp;&#x25B2;&nbsp;&nbsp;Armor / Shield / Defensive Staff / Other</button>
        </div>
        <div class="card-body">
          <div id="collapseArmor" class="collapse in">
            <table class="table stats itemstats">
              <thead>
                <tr>
                  <th class="w40">Item</th>
                  <th class="w35">Origin</th>
                  <th class="w15">Count</th>
                  <th class="w10">Scenarios</th>
                </tr>
              </thead>
              <% @armor.each do |item| %>
              <tr>
                <td class="item" align="center"><%= link_to item.name, item_path(item) %></td>
                <td><%= item.origin %></td>
                <td><%= item.count %></td>
                <td><%= item.scenarios.count %></td>
              </tr>
              <% end %>
            </table>
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-6 col-sm-8">
      <div class="card">
        <div class="card-header" id="headingObject">
          <button class="btn btn-link" data-toggle="collapse" data-target="#collapseObject">
          &#x25BC;&nbsp;&#x25B2;&nbsp;&nbsp;Object</button>
        </div>
        <div class="card-body">
          <div id="collapseObject" class="collapse in">
            <table class="table stats itemstats">
              <thead>
                <tr>
                  <th class="w40">Item</th>
                  <th class="w35">Origin</th>
                  <th class="w15">Count</th>
                  <th class="w10">Scenarios</th>
                </tr>
              </thead>
              <% @object.each do |item| %>
              <tr>
                <td class="item" align="center"><%= link_to item.name, item_path(item) %></td>
                <td><%= item.origin %></td>
                <td><%= item.count %></td>
                <td><%= item.scenarios.count %></td>
              </tr>
              <% end %>
            </table>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-header" id="headingDrink">
          <button class="btn btn-link" data-toggle="collapse" data-target="#collapseDrink">
          &#x25BC;&nbsp;&#x25B2;&nbsp;&nbsp;Drink</button>
        </div>
        <div class="card-body">
          <div id="collapseDrink" class="collapse in">
            <table class="table stats itemstats">
              <thead>
                <tr>
                  <th class="w40">Item</th>
                  <th class="w35">Origin</th>
                  <th class="w15">Count</th>
                  <th class="w10">Scenarios</th>
                </tr>
              </thead>
              <% @drink.each do |item| %>
              <tr>
                <td class="item" align="center"><%= link_to item.name, item_path(item) %></td>
                <td><%= item.origin %></td>
                <td><%= item.count %></td>
                <td><%= item.scenarios.count %></td>
              </tr>
              <% end %>
            </table>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-header" id="headingSpecial">
          <button class="btn btn-link" data-toggle="collapse" data-target="#collapseSpecial">
          &#x25BC;&nbsp;&#x25B2;&nbsp;&nbsp;Special / Campaign Item</button>
        </div>
        <div class="card-body">
          <div id="collapseSpecial" class="collapse in">
            <table class="table stats itemstats">
              <thead>
                <tr>
                  <th class="w40">Item</th>
                  <th class="w35">Origin</th>
                  <th class="w15">Count</th>
                  <th class="w10">Scenarios</th>
                </tr>
              </thead>
              <% @special.each do |item| %>
              <tr>
                <td class="item" align="center"><%= link_to item.name, item_path(item) %></td>
                <td><%= item.origin %></td>
                <td><%= item.count %></td>
                <td><%= item.scenarios.count %></td>
              </tr>
              <% end %>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div id="by_stat">
  <div class="row">
      <div class="panel panel-item">
        <div class="panel-heading">Name / Stats</div>
          <table class="table stats itemstats">
            <thead>
              <tr>
                <th>Item/Card<br />Name</th>
                <th>Item<br />Type</th>
                <th># of<br />Cards</th>
                <th>Encumb<br />Value</th>
                <th>Armor<br />Dice</th>
                <th>Melee<br />Dice</th>
                <th>Ranged<br />Dice</th>
                <th>Can be<br />Thrown</th>
                <th>Defense<br />Dice</th>
                <th>Damage<br />Dice</th>
                <th>Origin<br />&nbsp;</th>
              </tr>
            </thead>
            <% @items.sort_by {|item| item.name }.each do |item| %>
              <tr>
                <td class="item"><%= link_to item.name, item_path(item) %></td>
                <td><%= item.role %></td>
                <td><%= item.count %></td>
                <td><% if item.encumbrance != '' %><%= item.encumbrance %><% else %>-<% end %></td>

                <td class="stats">
                  <% if item.armor != '' %>
                    <% myHash = eval(item.dice) %>
                    <% myHash.each do |key, array| %>
                      <% if "#{key}" === "armor" %>
                        <% array.each do |die| %>
                          <% @bone_list.each do |bone| %>
                            <% if bone.id === die  %>
                              <%= image_tag "dice/#{bone.name}.png", :title => "#{bone.name}" %>
                            <% end %>
                          <% end %>
                        <% end %>
                      <% end %>
                    <% end %>
                  <% else %>--
                  <% end %>
                </td>
                <td class="stats">
                  <% if item.melee != '' %>
                    <% myHash = eval(item.dice) %>
                    <% myHash.each do |key, array| %>
                      <% if "#{key}" === "melee" %>
                        <% array.each do |die| %>
                          <% @bone_list.each do |bone| %>
                            <% if bone.id === die  %>
                              <%= image_tag "dice/#{bone.name}.png", :title => "#{bone.name}" %>
                            <% end %>
                          <% end %>
                        <% end %>
                      <% end %>
                    <% end %>
                  <% else %>--
                  <% end %>
                </td>
                <td class="stats">
                  <% if item.ranged != '' %>
                    <% myHash = eval(item.dice) %>
                    <% myHash.each do |key, array| %>
                      <% if "#{key}" === "ranged" %>
                        <% array.each do |die| %>
                          <% if die != 7 %>
                            <% @bone_list.each do |bone| %>
                              <% if bone.id === die %>
                                <%= image_tag "dice/#{bone.name}.png", :title => "#{bone.name}" %>
                              <% end %>
                            <% end %>
                          <% end %>
                        <% end %>
                      <% end %>
                    <% end %>
                  <% else %>--
                  <% end %>
                </td>
                <td class="stats">
                  <% if item.ranged != '' %>
                    <% myHash = eval(item.dice) %>
                    <% myHash.each do |key, array| %>
                      <% if "#{key}" === "ranged" %>
                        <% if array.include? 7 %>
                            &#x2714;
                        <% else %>--
                        <% end %>
                      <% end %>
                    <% end %>
                  <% else %>--
                  <% end %>
                </td>
                <td class="stats">
                  <% if item.defense != '' %>
                    <% myHash = eval(item.dice) %>
                    <% myHash.each do |key, array| %>
                      <% if "#{key}" === "defense" %>
                        <% array.each do |die| %>
                          <% @bone_list.each do |bone| %>
                            <% if bone.id === die  %>
                              <%= image_tag "dice/#{bone.name}.png", :title => "#{bone.name}" %>
                            <% end %>
                          <% end %>
                        <% end %>
                      <% end %>
                    <% end %>
                  <% else %>--
                  <% end %>
                </td>
                <td class="stats">
                  <% if item.manipulation != '' %>
                    <% myHash = eval(item.dice) %>
                    <% myHash.each do |key, array| %>
                      <% if "#{key}" === "manipulation" %>
                        <% array.each do |die| %>
                          <% @bone_list.each do |bone| %>
                            <% if bone.id === die && die != 8  %>
                              <%= image_tag "dice/#{bone.name}.png", :title => "#{bone.name}" %>
                            <% end %>
                          <% end %>
                        <% end %>
                      <% end %>
                    <% end %>
                  <% else %>--
                  <% end %>
                </td>
                <td><%= item.origin %></td>
              </tr>
          <% end %>
        </table>
      </div>
    </div>
  </div>


<script>
  $(document).ready(function() {
    $('a#show_byorigin').click(function(event){
      event.preventDefault();
      $('a.toggles').children().removeClass('active');
      $('a#show_byorigin').children().addClass('active');
      $('div#by_type').hide();
      $('div#by_stat').hide();
      $('div#by_origin').show();
    });

    $('a#show_bytype').click(function(event){
      event.preventDefault();
      $('a.toggles').children().removeClass('active');
      $('a#show_bytype').children().addClass('active');
      $('div#by_origin').hide();
      $('div#by_stat').hide();
      $('div#by_type').show();
    });

    $('a#show_bystat').click(function(event){
      event.preventDefault();
      $('a.toggles').children().removeClass('active');
      $('a#show_bystat').children().addClass('active');
      $('div#by_origin').hide();
      $('div#by_type').hide();
      $('div#by_stat').show();
    });

  });
</script>
