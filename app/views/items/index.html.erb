<h1 class="item">Item Cards</h1>
<% if logged_in? && current_user.admin? %>
  <p><%= link_to "Add an Item", new_item_path %></p>
<% end %>

<p>Click on a item to read more about it and any scenarios it appears in.</P>
  <p>Items can be sorted by:
      <ul>
        <li>the box <strong>(origin)</strong> the item card came in</li>
        <li>the <strong>type</strong> of item it is</li>
        <li><strong>All</strong> items listed with their stats</li>
      </ul>
<div align="center">
  <a href="" id="show_byorigin" class="toggles"><button class="btn btn-item active">By Origin</button></a>
  <a href="" id="show_bytype" class="toggles"><button class="btn btn-item">By Type</button></a>
  <a href="" id="show_bystat" class="toggles"><button class="btn btn-item">All / Stats</button></a>
</div>
<hr>

<div id="by_origin">
  <div class="row">
    <div class="col-md-4 col-sm-6">
      <div class="panel panel-item">
        <div class="panel-heading">Core Game Items</div>
        <table class="table">
          <% @core.sort_by {|item| item.name }.each do |item| %>
            <tr>
              <td class="item" align="center"><%= link_to item.name, item_path(item) %></td>
            </tr>
          <% end %>
        </table>
      </div>
      <div class="panel panel-item">
        <div class="panel-heading">Khitai Items</div>
        <table class="table">
          <% @khitai.sort_by {|item| item.name }.each do |item| %>
            <tr>
              <td class="item" align="center"><%= link_to item.name, item_path(item) %></td>
            </tr>
          <% end %>
        </table>
      </div>
    </div>
    <div class="col-md-4 col-sm-6">
      <div class="panel panel-item">
        <div class="panel-heading">Stretch Goal Items</div>
        <table class="table">
          <% @stretch.sort_by {|item| item.name }.each do |item| %>
            <tr>
              <td class="item" align="center"><%= link_to item.name, item_path(item) %></td>
            </tr>
          <% end %>
        </table>
      </div>
      <div class="panel panel-item">
        <div class="panel-heading">Nordheim Items</div>
        <table class="table">
          <% @nordheim.sort_by {|item| item.name }.each do |item| %>
            <tr>
              <td class="item" align="center"><%= link_to item.name, item_path(item) %></td>
            </tr>
          <% end %>
        </table>
      </div>
      <div class="panel panel-item">
        <div class="panel-heading">Stygia Items</div>
        <table class="table">
          <% @stygia.sort_by {|item| item.name }.each do |item| %>
            <tr>
              <td class="item" align="center"><%= link_to item.name, item_path(item) %></td>
            </tr>
          <% end %>
        </table>
      </div>
      <div class="panel panel-item">
        <div class="panel-heading">Brom Box Items</div>
        <table class="table">
          <% @brom.sort_by {|item| item.name }.each do |item| %>
            <tr>
              <td class="item" align="center"><%= link_to item.name, item_path(item) %></td>
            </tr>
          <% end %>
        </table>
      </div>
    </div>
    <div class="col-md-4 col-sm-6">
      <div class="panel panel-item">
        <div class="panel-heading">Legend of the Devil in Iron Items</div>
        <table class="table">
          <% @campaign.sort_by {|item| item.name }.each do |item| %>
            <tr>
              <td class="item" align="center"><%= link_to item.name, item_path(item) %></td>
            </tr>
          <% end %>
        </table>
      </div>
    </div>

  </div>
</div>

<div id="by_type">
  <div class="row">
    <div class="col-md-4 col-sm-6">
      <div class="panel panel-item">
        <div class="panel-heading">Weapons</div>
        <table class="table">
          <% @weapon.sort_by {|item| item.name }.each do |item| %>
            <tr>
              <td class="item" align="center"><%= link_to item.name, item_path(item) %></td>
            </tr>
          <% end %>
        </table>
      </div>
    </div>
    <div class="col-md-4 col-sm-6">
      <div class="panel panel-item">
        <div class="panel-heading">Armor / Shields / Defensive Staves / Other</div>
        <table class="table">
          <% @armor.sort_by {|item| item.name }.each do |item| %>
            <tr>
              <td class="item" align="center"><%= link_to item.name, item_path(item) %></td>
            </tr>
          <% end %>
        </table>
      </div>
      <div class="panel panel-item">
        <div class="panel-heading">Drink</div>
        <table class="table">
          <% @drink.sort_by {|item| item.name }.each do |item| %>
            <tr>
              <td class="item" align="center"><%= link_to item.name, item_path(item) %></td>
            </tr>
          <% end %>
        </table>
      </div>
      <div class="panel panel-item">
        <div class="panel-heading">Special / Campaign Items</div>
        <table class="table">
          <% @special.sort_by {|item| item.name }.each do |item| %>
            <tr>
              <td class="item" align="center"><%= link_to item.name, item_path(item) %></td>
            </tr>
          <% end %>
        </table>
      </div>
    </div>
    <div class="col-md-4 col-sm-6">
      <div class="panel panel-item">
        <div class="panel-heading">Objects</div>
        <table class="table">
          <% @object.sort_by {|item| item.name }.each do |item| %>
            <tr>
              <td class="item" align="center"><%= link_to item.name, item_path(item) %></td>
            </tr>
          <% end %>
        </table>
      </div>
    </div>
  </div>
</div>

<div id="by_stat">
  <div class="row">
      <div class="panel panel-item">
        <div class="panel-heading">All Tiles / Stats</div>
          <table class="table stats itemstats">
            <thead>
              <tr>
                <th>Item/Card<br />Name</th>
                <th>Type<br />&nbsp;</th>
                <th>Number<br />of Cards</th>
                <th>Encumbrance<br />Value</th>
                <th>Armor<br /> Dice</th>
                <th>Melee<br /> Dice</th>
                <th>Ranged<br /> Dice</th>
                <th>Defense<br /> Dice</th>
                <th>Manipulation<br />Dice</th>
                <th>Origin<br />&nbsp;</th>
              </tr>
            </thead>
            <% @items.sort_by {|item| item.name }.each do |item| %>
              <tr>
                <td class="item"><%= link_to item.name, item_path(item) %></td>
                <td><%= item.role %></td>
                <td><%= item.count %></td>
                <td><% if item.encumbrance != '' %><%= item.encumbrance %><% else %>-<% end %></td>

                <td class="stats">
                  <% if item.armor != '' %>
                    <% myHash = eval(item.dice) %>
                    <% myHash.each do |key, array| %>
                      <% if "#{key}" === "armor" %>
                        <% array.each do |die| %>
                          <% @bone_list.each do |bone| %>
                            <% if bone.id === die  %>
                              <%= image_tag "dice/#{bone.name}.png", :title => "#{bone.name}" %>
                            <% end %>
                          <% end %>
                        <% end %>
                      <% end %>
                    <% end %>
                  <% else %>--
                  <% end %>
                </td>
                <td class="stats">
                  <% if item.melee != '' %>
                    <% myHash = eval(item.dice) %>
                    <% myHash.each do |key, array| %>
                      <% if "#{key}" === "melee" %>
                        <% array.each do |die| %>
                          <% @bone_list.each do |bone| %>
                            <% if bone.id === die  %>
                              <%= image_tag "dice/#{bone.name}.png", :title => "#{bone.name}" %>
                            <% end %>
                          <% end %>
                        <% end %>
                      <% end %>
                    <% end %>
                  <% else %>--
                  <% end %>
                </td>
                <td class="stats">
                  <% if item.ranged != '' %>
                    <% myHash = eval(item.dice) %>
                    <% myHash.each do |key, array| %>
                      <% if "#{key}" === "ranged" %>
                        <% array.each do |die| %>
                          <% @bone_list.each do |bone| %>
                            <% if bone.id === die  %>
                              <%= image_tag "dice/#{bone.name}.png", :title => "#{bone.name}" %>
                            <% end %>
                          <% end %>
                        <% end %>
                      <% end %>
                    <% end %>
                  <% else %>--
                  <% end %>
                </td>
                <td class="stats">
                  <% if item.defense != '' %>
                    <% myHash = eval(item.dice) %>
                    <% myHash.each do |key, array| %>
                      <% if "#{key}" === "defense" %>
                        <% array.each do |die| %>
                          <% @bone_list.each do |bone| %>
                            <% if bone.id === die  %>
                              <%= image_tag "dice/#{bone.name}.png", :title => "#{bone.name}" %>
                            <% end %>
                          <% end %>
                        <% end %>
                      <% end %>
                    <% end %>
                  <% else %>--
                  <% end %>
                </td>
                <td class="stats">
                  <% if item.manipulation != '' %>
                    <% myHash = eval(item.dice) %>
                    <% myHash.each do |key, array| %>
                      <% if "#{key}" === "manipulation" %>
                        <% array.each do |die| %>
                          <% @bone_list.each do |bone| %>
                            <% if bone.id === die  %>
                              <%= image_tag "dice/#{bone.name}.png", :title => "#{bone.name}" %>
                            <% end %>
                          <% end %>
                        <% end %>
                      <% end %>
                    <% end %>
                  <% else %>--
                  <% end %>
                </td>
                <td><%= item.origin %></td>
              </tr>
          <% end %>
        </table>
      </div>
    </div>
  </div>


<script>
  $(document).ready(function() {
    $('a#show_byorigin').click(function(event){
      event.preventDefault();
      $('a.toggles').children().removeClass('active');
      $('a#show_byorigin').children().addClass('active');
      $('div#by_type').hide();
      $('div#by_stat').hide();
      $('div#by_origin').show();
    });

    $('a#show_bytype').click(function(event){
      event.preventDefault();
      $('a.toggles').children().removeClass('active');
      $('a#show_bytype').children().addClass('active');
      $('div#by_origin').hide();
      $('div#by_stat').hide();
      $('div#by_type').show();
    });

    $('a#show_bystat').click(function(event){
      event.preventDefault();
      $('a.toggles').children().removeClass('active');
      $('a#show_bystat').children().addClass('active');
      $('div#by_origin').hide();
      $('div#by_type').hide();
      $('div#by_stat').show();
    });

  });
</script>
